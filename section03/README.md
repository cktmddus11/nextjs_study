# μ„Ήμ… 3 : App Router μ‹μ‘ν•κΈ°

## 29.3.1) App Router μ‹μ‘ν•κΈ°
### λ³€κ²½λκ±°λ‚ μ¶”κ°€λλ” μ‚¬ν•­
- React 18 μ‹ κ· κΈ°λ¥ μ¶”κ°€
- λ°μ΄ν„° ν¨μΉ­ λ°©μ‹ λ³€κ²½
- λ μ΄μ•„μ›ƒ μ„¤μ • λ°©μ‹ λ³€κ²½
- νμ΄μ§€ λΌμ°ν… μ„¤μ • λ°©μ‹ λ³€κ²½
### ν¬κ² λ³€κ²½λμ§€ μ•λ” μ‚¬ν•­
- λ„¤λΉ„κ²μ΄ν…(Navigating)
- ν”„λ¦¬νμΉ­(Pre-Fetching)
- μ‚¬μ „ λ λ”λ§(Pre-Rendering)

### section03 μƒμ„± λ…λ Ήμ–΄
- npx create-next-app@latest section03 : next js μ μµμ‹ λ²„μ „ μ•± μƒμ„±
- typescript, eslint, app router

### ν΄λ” κµ¬μ΅° μ‚΄ν΄λ³΄κΈ°
- page.tsx - νμ΄μ§€
- layout.tsx - λ μ΄μ•„μ›ƒ


## 30.3.2) νμ΄μ§€ λΌμ°ν… μ„¤μ •ν•κΈ°
### queryString 
- λ””λ ‰ν† λ¦¬ κµ¬μ΅° : app/search/page.tsx
ex) search?id=4 
  - searchParam κ°μ²΄μ Promiseν•νƒλ΅ μ΅΄μ¬ν•¨.
### urlParameter
- λ””λ ‰ν† λ¦¬ κµ¬μ΅° : app/book/[id]/page.tsx
ex) book/3
- params κ°μ²΄κ°€ Promise ν•νƒλ΅ μ΅΄μ¬ν•¨.

## 31.3.3) λ μ΄μ•„μ›ƒ μ„¤μ •ν•κΈ°
### λ μ΄μ•„μ›ƒ
- layout.tsx, page.tsx : layout μ»΄ν¬λ„νΈ μ•μ— pageκ°€ ν¬ν•¨λ κµ¬μ΅°
- layout.tsxκ°€ μλ” ν΄λ”κ²½λ΅ ν•μ„ ν΄λ”κ°€ μ΅΄μ¬ν•λ‹¤λ©΄ ν•μ„ν΄λ”μ—λ” μ¤‘μ²©λμ–΄ layoutμ΄ μ μ©λ¨.
```bash
π“‚ app
β”β”€β”€ π“‚ dashboard
β”‚   β”β”€β”€ layout.tsx        # /dashboardμ— μ μ©λλ” λ μ΄μ•„μ›ƒ
β”‚   β”β”€β”€ page.tsx          # /dashboard νμ΄μ§€
β”‚   β””β”€β”€ π“‚ settings
β”‚       β””β”€β”€ page.tsx      # /dashboard/settings νμ΄μ§€

```
- layout.tsx - μμ‹ μ»΄ν¬λ„νΈμΈ page μ»΄ν¬λ„νΈλ¥Ό children props λ΅ μ „λ‹¬ν•΄μ¤μ•Όν•¨.
```typescript
// app/dashboard/layout.tsx
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div>
      <nav>Dashboard Navigation</nav>
      <main>{children}</main>
    </div>
  );
}

```

### λΌμ°νΈ κ·Έλ£Ή
- κ²½λ΅μƒμ—λ” μν–¥μ„ λ―ΈμΉμ§€ μ•λ” ν”λ”.
- κ·Έλ£ΉμΌλ΅ λ¬¶μΈ κ²½λ΅μ— λ™μΌν• layout μ„ μ μ©ν•κΈ° μ„ν•΄μ„
ex) search, index page μ μ©μ‹

## 32. 3.4) λ¦¬μ•΅νΈ μ„λ²„ μ»΄ν¬λ„νΈ μ΄ν•΄ν•κΈ°
### React Server Component μ΄ν•΄ν•κΈ°
- React Server Component
  - React 18v λ¶€ν„° μƒλ΅­κ² μ¶”κ°€λ, μƒλ΅μ΄ μ ν•μ μ»΄ν¬λ„νΈ
  - μ„λ²„μΈ΅μ—μ„λ§ μ‹¤ν–‰λλ” μ»΄ν¬λ„νΈ(λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰ X)

- page router μ—μ„λ”
  - js bundle μ„ λ§λ“¤λ• ν•„μ”ν• νμ΄μ§€μ™€ μ—°κ΄€λ λ¨λ“  μ»΄ν¬λ„νΈλ¥Ό λ²λ“¤λ§ν•κΈ° λ•λ¬Έμ— λ¶ν•„μ”ν•κ² μ©λ‰μ΄ μ»¤μ§
  - ν•΄κ²° λ°©μ• : μƒνΈμ‘μ©μ΄ μ—†λ” μ»΄ν¬λ„νΈλ“¤ μ¦‰ λΈλΌμ°μ €μ—μ„ ν•μ΄λ“λ μ΄μ… λ  ν•„μ”μ—†λ” μ»΄ν¬λ„νΈλ¥Ό λ²λ“¤μ—μ„ μ μ™Έν•κΈ°

- μ„λ²„μ»΄ν¬λ„νΈ : μ„λ²„μΈ΅μ—μ„ μ‚¬μ „ λ λ”λ§μ„ μ§„ν–‰ν•  λ• λ”±ν•λ² μ‹¤ν–‰λ¨
- ν΄λΌμ΄μΈνΈ μ»΄ν¬λ„νΈ : μ‚¬μ „ λ λ”λ§ μ§„ν–‰ν•  λ• ν•λ², ν•μ΄λ“λ μ΄μ… μ§„ν–‰ν•  λ• ν•λ². μ΄ 2λ² μ‹¤ν–‰.
> νμ΄μ§€μ λ€λ¶€λ¶„μ„ μ„λ²„ μ»΄ν¬λ„νΈλ΅ κµ¬μ„±ν•  κ²ƒμ„ κ¶μ¥.   
> ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” κΌ­ ν•„μ”ν• κ²½μ°μ—λ§ μ‚¬μ©ν•  κ²ƒ.



- page.tsx : κΈ°λ³Έμ μΌλ΅ μ„λ²„ μ»΄ν¬λ„νΈ
  - useEffect λ“± ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‹¤ν–‰λλ” ν•¨μ μ‚¬μ© λ¶κ°€    
    => ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ³€κ²½ν•  μ»΄ν¬λ„νΈ μƒλ‹¨μ— "use client"; 

## μ–΄λ–¨λ• ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ, μ„λ²„ μ»΄ν¬λ„νΈ?
- μƒνΈμ‘μ©μ΄ μλ” μ»΄ν¬λ„νΈ    
  ex) search bar

## co-location
- searchbar.tsx κ°™μ΄ page, layout μ μ™Έν• μ»΄ν¬λ„νΈ, app ν΄λ”μ— λ‹¤ λ¨μ•„λ†”λ„ λ¨.


## 33. 3.5) λ¦¬μ—‘νΈ μ„λ²„ μ»΄ν¬λ„νΈ μ£Όμμ‚¬ν•­
### React Server Component μ£Όμμ‚¬ν•­
1. **μ„λ²„ μ»΄ν¬λ„νΈ**μ—λ” λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λ  μ½”λ“κ°€ ν¬ν•¨λλ©΄ μ•λ¨.   
ex) React Hooks, μ΄λ²¤νΈ ν•Έλ“¤λ¬, λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λλ” κΈ°λ¥μ„ λ‹΄κ³  μλ” λΌμ΄λΈλ¬λ¦¬
2. ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ” ν΄λΌμ΄μ–ΈνΈμ—μ„λ§ μ‹¤ν–‰λμ§€ μ•μ.   

   | μ„λ²„ μ»΄ν¬λ„νΈ                                                        |                                                              ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ                                                               |
   |----------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------:|
   | μ„λ²„μΈ΅μ—μ„λ§ μ‹¤ν–‰λλ” μ»΄ν¬λ„νΈ <br> => μ„λ²„μΈ΅μ—μ„λ§ μ‹¤ν–‰λκΈ° λ•λ¬Έμ— λ²λ“¤λ§ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬ν•μ§€ μ•μ | - μ‚¬μ „ λ λ”λ§μ„ μ„ν•΄ μ„λ²„μ—μ„ 1λ² μ‹¤ν–‰    <br>     ~  ν•μ΄λ“λ μ΄μ…μ„ μ„ν•΄ λΈλΌμ°μ €μ—μ„ 1λ² μ‹¤ν–‰ <br> => μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ¨λ‘ μ‹¤ν–‰λ¨    <br>=> λΈλΌμ°μ €μ—μ„ μ‹¤ν–‰λκΈ° λ•λ¬Έμ— ν΄λΌμ΄μ–ΈνΈλ΅ λ²λ“¤λ§λμ–΄ μ „μ†΅λ¨. |

3. ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό import ν•  μ μ—†μ.
- JS λ²λ“¤ μ‹ μ„λ²„ μ»΄ν¬λ„νΈλ” μ—†κΈ° λ•λ¬Έμ— import ν•  μ μ—†μ§€λ§    
next js λ” μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό ν΄λ¦¬μ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ λ°”κΏ”λ²„λ¦°λ‹¤.
λ•λ¬Έμ— ν΄λΌμ΄μ–ΈνΈ μμ‹ μ»΄ν¬λ„νΈλ΅ μ„λ²„ μ»΄ν¬λ„νΈ import λ¥Ό μμ  ν•΄μ•Όν•λ‹¤. 
=> λ€μ‹  propsλ‚ childrenμΌλ΅ μ „λ‹¬λ°›μ•„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
4. μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—κ² μ§λ ¬ν™” λμ§€ μ•λ” Propsλ” μ „λ‹¬ λ¶κ°€λ¥ν•λ‹¤.   
λ°νƒ€μ„ μ—λ¬λ‚¨. 
> **μ§λ ¬ν™”(Serialization)**    
> κ°μ²΄, λ°°μ—΄, ν΄λμ¤ λ“±μ λ³µμ΅ν• κµ¬μ΅°μ λ°μ΄ν„°λ¥Ό  
> λ„¤νΈμ›ν¬ μƒμΌλ΅ μ „μ†΅ν•κΈ° μ„ν•΄ μ•„μ£Ό λ‹¨μν• ν•νƒ(λ¬Έμμ—΄, Byte)λ΅ λ³€ν™ν•λ”κ²ƒ.
>  - μ§λ ¬ν™” κ°€λ¥ν• λ°μ΄ν„°:
>     - λ¬Έμμ—΄, μ«μ, λ¶λ¦¬μ–Έ λ“±μ κΈ°λ³Έ νƒ€μ…
>     - λ°°μ—΄, κ°μ²΄ (λ‹¨, λ©”μ„λ“λ¥Ό ν¬ν•¨ν•μ§€ μ•λ” μμ λ°μ΄ν„° κ°μ²΄)
> - μ§λ ¬ν™” λ¶κ°€λ¥ν• λ°μ΄ν„°:
>     - ν•¨μ
>     - ν΄λμ¤ μΈμ¤ν„΄μ¤
>     - Date κ°μ²΄
>     - Map, Set λ“±μ νΉμ κ°μ²΄
>     - DOM λ…Έλ“

> **μ‚¬μ „ λ λ”λ§ κ³Όμ •**
> 1. νμ΄μ§€λ¥Ό κµ¬μ„±ν•λ” λ¨λ“  μ»΄ν¬λ„νΈλ“¤
> 2. μ„λ²„ μ»΄ν¬λ„νΈλ“¤λ§ λ”°λ΅ μ‹¤ν–‰(RSC Payload)
> 3. μ™„μ„±λ HTML νμ΄μ§€ 
>> **RSC Payload**
>> * μ„λ²„ μ»΄ν¬λ„νΈλ“¤λ§ λ”°λ΅ μ‹¤ν–‰λλ” κ³Όμ •μ—μ„ μƒμ„±λλ” λ°μ΄ν„°
>> * μ΄ λ°μ΄ν„°λ” μµμΆ…μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „λ‹¬λμ–΄ νμ΄μ§€λ¥Ό κµ¬μ„±ν•λ”λ° μ‚¬μ©λ¨. 
>> * React Server Component μ μμν• λ°μ΄ν„°(κ²°κ³Όλ¬Ό)
>> * React Server Componentλ¥Ό μ§λ ¬ν™” ν• κ²°κ³Ό ex) json ν•μ‹
>> * RSC Payloadμ—λ” μ„λ²„ μ»΄ν¬λ„νΈμ λ¨λ“  λ°μ΄ν„°κ°€ ν¬ν•¨λ¨.
>>      * μ„λ²„ μ»΄ν¬λ„νΈμ λ λ”λ§ κ²°κ³Ό
        * μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ„μΉ
        * ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—κ² μ „λ‹¬λλ” κ°’

![RSC Payload](../img/RSC_Payload.png) 